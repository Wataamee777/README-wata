<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ã•ãã‚‰é›‘è«‡ç‹å›½ãŠé¡Œbotã¸è¿½åŠ ãƒ•ã‚©ãƒ¼ãƒ </title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    h2 {
      text-align: center;
    }

    input {
      width: 90%;
      padding: 10px;
      font-size: 16px;
      margin-bottom: 10px;
      box-sizing: border-box;
    }

    button {
      padding: 10px 20px;
      font-size: 16px;
      cursor: pointer;
      margin-bottom: 10px;
    }

    #msg {
      margin-bottom: 10px;
      color: green;
    }

    /* iframeãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–è¨­å®š */
    #sheetFrame {
      width: 100%;
      border: none;
      height: 500px; /* ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆé«˜ã• */
    }

    @media screen and (min-width: 1024px) {
      #sheetFrame { height: 800px; }
    }

    @media screen and (min-width: 768px) and (max-width: 1023px) {
      #sheetFrame { height: 700px; }
    }

    @media screen and (max-width: 767px) {
      #sheetFrame { height: 500px; }
    }
  </style>
</head>
<body>
  <h2>ğŸ“ ãŠé¡Œã‚’è¿½åŠ ã™ã‚‹</h2>

  <input type="text" id="topic" placeholder="ä¾‹ï¼šå¥½ããªé£Ÿã¹ç‰©ã¯ï¼Ÿ">
  <button id="submitBtn">è¿½åŠ ï¼</button>
  <p id="msg"></p>

  <!-- Google ã‚¹ãƒ—ãƒ¬ãƒƒãƒ‰ã‚·ãƒ¼ãƒˆåŸ‹ã‚è¾¼ã¿ -->
  <iframe id="sheetFrame"
          src="https://docs.google.com/spreadsheets/d/e/2PACX-1vSMHbfMbzKKDlDp2rBoi8b-dklWs4ytjsechM8kBTfpGq_c43D4_OEzsjCF0NOTm0xHk2qy9nQoQdYX/pubhtml?widget=true&headers=false">
  </iframe>

  <script>
    const submitBtn = document.getElementById('submitBtn');
    const topicInput = document.getElementById('topic');
    const msg = document.getElementById('msg');

    submitBtn.addEventListener('click', async () => {
      const topic = topicInput.value.trim();
      if (!topic) {
        msg.textContent = "ãŠé¡Œã‚’å…¥åŠ›ã—ã¦ã­ï¼";
        return;
      }

      // é€ä¿¡ä¸­ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸
      msg.textContent = "é€ä¿¡ä¸­â€¦";
      submitBtn.disabled = true;

      try {
        // GAS Webã‚¢ãƒ—ãƒªã® URL ã« POST
        const response = await fetch('https://script.google.com/macros/s/YOUR_GAS_ID/exec', {
          method: 'POST',
          mode: 'cors', // CORSå›é¿ã—ã¦ã„ã‚‹ãªã‚‰OK
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ topic })
        });

        if (response.ok) {
          msg.textContent = "ãŠé¡ŒãŒè¿½åŠ ã•ã‚ŒãŸã‚ˆï¼";
          topicInput.value = "";
        } else {
          msg.textContent = "é€ä¿¡ã«å¤±æ•—ã—ã¾ã—ãŸ";
        }
      } catch (err) {
        console.error(err);
        msg.textContent = "é€šä¿¡ã‚¨ãƒ©ãƒ¼";
      }

      submitBtn.disabled = false;
    });
  </script>
</body>
</html>
