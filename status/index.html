<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ã•ãã‚‰bot & ã¯ã¨ã‚ã’ ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root {
  --ok: #22c55e;
  --warn: #f59e0b;
  --error: #ef4444;
  --bg: #020617;
  --card: #020617;
  --text: #e5e7eb;
  --sub: #94a3b8;
}

* { box-sizing: border-box; }

body {
  margin: 0;
  padding: 20px;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: var(--bg);
  color: var(--text);
}

h1 {
  margin-bottom: 16px;
  font-size: 1.6rem;
}

#status {
  display: grid;
  gap: 12px;
}

.card {
  background: var(--card);
  border-radius: 12px;
  padding: 16px;
  border-left: 6px solid;
  box-shadow: 0 8px 24px rgba(0,0,0,.35);
  animation: fadeIn .25s ease;
}

.ok { border-color: var(--ok); }
.warn { border-color: var(--warn); }
.error { border-color: var(--error); }

.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 6px;
}

.name {
  font-weight: 700;
  font-size: 1.05rem;
}

.badge {
  padding: 2px 10px;
  border-radius: 999px;
  font-size: .75rem;
  font-weight: 600;
}

.ok .badge { background: #14532d; color: #86efac; }
.warn .badge { background: #78350f; color: #fde68a; }
.error .badge { background: #7f1d1d; color: #fecaca; }

.meta {
  font-size: .85rem;
  color: var(--sub);
  line-height: 1.6;
}

.loading {
  opacity: .6;
  font-size: .9rem;
}

footer {
  margin-top: 20px;
  font-size: .75rem;
  color: var(--sub);
  opacity: .7;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(6px); }
  to { opacity: 1; transform: translateY(0); }
}
</style>
</head>

<body>
<h1>ğŸ“¡ ã‚µãƒ¼ãƒ“ã‚¹ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹</h1>

<div id="status">
  <div class="loading">ãƒã‚§ãƒƒã‚¯ä¸­â€¦</div>
</div>

<footer>
  è‡ªå‹•æ›´æ–°: 5åˆ†ã”ã¨ / GitHub Actions
</footer>

<script>
const statusEl = document.getElementById("status");

function classify(http, ms) {
  if (http !== 200 && http !== 301) return ["error", "DOWN"];
  if (ms === null) return ["warn", "NO RESP"];
  if (ms > 500) return ["warn", "SLOW"];
  return ["ok", "ONLINE"];
}

async function fetchStatus() {
  try {
    const res = await fetch("./status.json", { cache: "no-store" });
    if (!res.ok) throw new Error("fetch failed");

    const data = await res.json();
    statusEl.innerHTML = "";

    for (const name in data) {
      const s = data[name];
      const [cls, label] = classify(s.http, s.http_ms);

      const speed =
        s.http_ms === null ? "â€”" : `${s.http_ms} ms`;

      statusEl.insertAdjacentHTML("beforeend", `
        <div class="card ${cls}">
          <div class="header">
            <div class="name">${name}</div>
            <div class="badge">${label}</div>
          </div>
          <div class="meta">
            DNS: ${s.nslookup}<br>
            HTTP: ${s.http}<br>
            Response: ${speed}<br>
            Last Check: ${new Date(s.checked_at).toLocaleString()}
          </div>
        </div>
      `);
    }
  } catch (e) {
    statusEl.innerHTML = `
      <div class="card error">
        <div class="name">ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹å–å¾—å¤±æ•—</div>
        <div class="meta">status.json ã‚’å–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ</div>
      </div>
    `;
    console.error(e);
  }
}

fetchStatus();
setInterval(fetchStatus, 300000);
</script>
</body>
</html>
