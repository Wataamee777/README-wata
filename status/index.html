<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>さくらbot&はとあげステータス</title>
<style>
  body { font-family: sans-serif; padding: 20px; background: #f5f5f5; }
  h1 { color: #333; }
  .site { margin-bottom: 10px; padding: 10px; border-radius: 5px; }
  .ok { background: #d4edda; color: #155724; }
  .warn { background: #fff3cd; color: #856404; }
  .error { background: #f8d7da; color: #721c24; }
</style>
</head>
<body>
<h1>サイトステータス</h1>
<div id="status"></div>

<script>
async function fetchStatus() {
  try {
    const res = await fetch('/status.json');
    const data = await res.json();
    const container = document.getElementById('status');
    container.innerHTML = '';

    for (const site in data) {
      const s = data[site];
      let cls = (s.http === 200 || s.http === 301) ? 'ok' :
                (s.http === 401) ? 'warn' : 'error';
      container.innerHTML += `<div class="site ${cls}">
        <strong>${site}</strong><br>
        NS: ${s.nslookup} | Ping: ${s.ping} | HTTP: ${s.http}<br>
        Last checked: ${new Date(s.checked_at).toLocaleString()}
      </div>`;
    }
  } catch (e) {
    document.getElementById('status').innerHTML = 'ステータス取得エラー';
    console.error(e);
  }
}

fetchStatus();
setInterval(fetchStatus, 300000); // 5分ごと自動更新
</script>
</body>
</html>
